


<!doctype html>
<html class="no-js" lang="en">
  
<head><!-- begin head.html -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>
    Alternator: DynamoDB API in Scylla | Scylla Docs
    </title>
    <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server."/>

    <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon"/>
    <link rel="canonical" href="https://docs.scylladb.com/">

    <link rel="author" href="mailto:info@scylladb.com">
    <link rel="stylesheet" href="../_static/" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/tabs.css" />
    
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/foundation.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/doc/main.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>

    <script src="../_static/js/vendor/modernizr.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T8P2JP');</script>
    <!-- End Google Tag Manager -->

    <!-- Marketo -->
    <script type="text/javascript"> (function() { var didInit = false; function initMunchkin() { if(didInit === false) { didInit = true; Munchkin.init('791-QBF-350'); } } var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//munchkin.marketo.net/munchkin.js'; s.onreadystatechange = function() { if (this.readyState == 'complete' || this.readyState == 'loaded') { initMunchkin(); } }; s.onload = initMunchkin; document.getElementsByTagName('head')[0].appendChild(s); })(); </script>
    <!-- End Marketo -->

<!-- end head.html -->
</head>

<body>


    <section class="custom-promo-banner-wrap">
    <div class="custom-promo-banner--relative">
        <div class="custom-promo-banner--img-left">
            <img src="../_static/img/Scylla-Summit-Banner-globs-left.svg">
        </div>
        <div class="custom-promo-banner--img-center">
            <img src="../_static/img/Scylla-Summit-Banner-globs-middle.svg">
        </div>
        <div class="custom-promo-banner--img-right">
            <img src="../_static/img/Scylla-Summit-Banner-globs-right.svg">
        </div>

        <div class="custom-promo-banner">
            <img class="custom-promo-banner--logo" src="../_static/img/slide-summit21-logo@2x.png" alt="">
            <div class="custom-promo-banner--title summit">Database Monsters of the World Connect! Virtual Conference | January 12-14</div>
            <a class="custom-promo-banner--button summit" href="https://scylladb.com/scylla-summit-2021/">Register Now <i class="fa fa-angle-right" style="margin-left: 10px;" aria-hidden="true"></i></a><button class="custom-promo-banner--close">×</button>
        </div>
    </div>
</section>



<header id="header" class="animated">
    <div class="topbar_continer contain-to-grid clearfix">
        <nav class="top-bar" id="top-bar" data-topbar role="navigation">
            <ul class="title-area">
                <li class="name">
                    <div class="logo">
                        <a href="https://docs.scylladb.com/"><img src="../_static/img/logo-scylla-docs.svg" alt="" width="151"></a>
                    </div>
                </li>
                <li class="toggle-topbar"><a href="#"><span class="icon-manu"></span></a></li>
            </ul>
            <section class="top-bar-section clearfix">
                <ul class="right">
                    
                    <li>
                        <a href="https://scylladb.github.io/scylla">Scylla Developer Notes</a>
                    </li>
                    
                    <li>
                        <a href="https://university.scylladb.com/">Scylla University</a>
                    </li>
                    
                    <li>
                        <a href="https://www.scylladb.com/">ScyllaDB Home</a>
                    </li>
                    
                    <li class="search_continer show-for-medium-up">	
                        <ci-search></ci-search>	
                    </li>	
                </ul>
            </section>
        </nav>
    </div>
</header>
<section id="content">
    <div class="row">
	
	<div class="large-6 large-push-3 columns">

        

        <div class="section" id="alternator-dynamodb-api-in-scylla">
<h1>Alternator: DynamoDB API in Scylla<a class="headerlink" href="#alternator-dynamodb-api-in-scylla" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Alternator is a Scylla feature adding compatibility with Amazon DynamoDB(TM).
DynamoDB’s API uses JSON-encoded requests and responses which are sent over
an HTTP or HTTPS transport. It is described in detail on Amazon’s site:
https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/</p>
<p>Our goal is that any application written to use Amazon DynamoDB could
be run, unmodified, against Scylla with Alternator enabled. However, at this
stage the Alternator implementation is incomplete, and some of DynamoDB’s
API features are not yet supported. The extent of Alternator’s compatibility
with DynamoDB is described in the “current compatibility” section below.</p>
</div>
<div class="section" id="running-alternator">
<h2>Running Alternator<a class="headerlink" href="#running-alternator" title="Permalink to this headline">¶</a></h2>
<p>By default, Scylla does not listen for DynamoDB API requests. To enable
such requests, you must set the <code class="docutils literal notranslate"><span class="pre">alternator-port</span></code> configuration option
(via command line or YAML) to the port on which you wish to listen for
DynamoDB API requests.</p>
<p>For example., “<code class="docutils literal notranslate"><span class="pre">--alternator-port=8000</span></code>” on the command line will run
Alternator on port 8000 - the traditional port used by DynamoDB.</p>
<p>By default, Scylla listens on this port on all network interfaces.
To listen only on a specific interface, pass also an “<code class="docutils literal notranslate"><span class="pre">alternator-address</span></code>”
option.</p>
<p>In addition to (or instead of) serving HTTP requests on <code class="docutils literal notranslate"><span class="pre">alternator-port</span></code>,
Scylla can accept DynamoDB API requests over HTTPS (encrypted), on the port
specified by <code class="docutils literal notranslate"><span class="pre">alternator-https-port</span></code>. As usual for HTTPS servers, the
operator must specify certificate and key files. By default these should
be placed in <code class="docutils literal notranslate"><span class="pre">/etc/scylla/scylla.crt</span></code> and <code class="docutils literal notranslate"><span class="pre">/etc/scylla/scylla.key</span></code>, but
these default locations can overridden by specifying
<code class="docutils literal notranslate"><span class="pre">--alternator-encryption-options</span> <span class="pre">keyfile=&quot;...&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">--alternator-encryption-options</span> <span class="pre">certificate=&quot;...&quot;</span></code>.</p>
<p>As we explain below in the “Write isolation policies”, Alternator has
four different choices for the implementation of writes, each with
different advantages. You should consider which of the options makes
more sense for your intended use case, and use the “<code class="docutils literal notranslate"><span class="pre">--alternator-write-isolation</span></code>”
option to choose one. There is currently no default for this option: Trying
to run Scylla with Alternator enabled without passing this option will
result in an error asking you to set it.</p>
<p>DynamoDB applications specify a single “endpoint” address, e.g.,
<code class="docutils literal notranslate"><span class="pre">dynamodb.us-east-1.amazonaws.com</span></code>. Behind the scenes, a DNS server and/or
load balancers distribute the connections to many different backend nodes.
Alternator does not provide such a load-balancing setup, so you should
either set one up, or set up the client library to do the load balancing
itself. Instructions, code and examples for doing this can be found in:
https://github.com/scylladb/alternator-load-balancing/</p>
<p>Alternator tables are stored as Scylla tables, each in a separate keyspace.
Each keyspace is initialized when the corresponding Alternator table is
created (with a CreateTable request). The replication factor (RF) for this
keyspace is chosen at that point, depending on the size of the cluster:
RF=3 is used on clusters with three or more nodes, and RF=1 is used for
smaller clusters. Such smaller clusters are, of course, only recommended
for tests because of the risk of data loss.</p>
</div>
<div class="section" id="current-compatibility-with-dynamodb">
<h2>Current compatibility with DynamoDB<a class="headerlink" href="#current-compatibility-with-dynamodb" title="Permalink to this headline">¶</a></h2>
<p>Our goal is that any application written to use Amazon DynamoDB could
be run, unmodified, against Scylla with Alternator enabled. However, at this
stage the Alternator implementation is incomplete, and some of DynamoDB’s
API features are not yet supported. This section documents the extent of
Alternator’s compatibility with DynamoDB, and will be updated as the work
progresses and compatibility continues to improve.</p>
<div class="section" id="api-server">
<h3>API Server<a class="headerlink" href="#api-server" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Transport: HTTP and HTTPS are mostly supported, but small features like CRC
header and compression are still missing.</p></li>
<li><p>Authorization (verifying the originator of the request): implemented
on top of system_auth.roles table. The secret key used for authorization
is the salted_hash column from the roles table, selected with:
SELECT salted_hash from system_auth.roles WHERE role = USERNAME;
By default, authorization is not enforced at all. It can be turned on
by providing an entry in Scylla configuration:
alternator_enforce_authorization: true</p></li>
<li><p>Load balancing: Not a part of Alternator. One should use an external load
balancer or DNS server to balance the requests between the live Scylla
nodes, or a modification to the client library. For more information, see
https://github.com/scylladb/alternator-load-balancing/.</p></li>
</ul>
</div>
<div class="section" id="table-operations">
<h3>Table Operations<a class="headerlink" href="#table-operations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>CreateTable and DeleteTable: Supported. Note our implementation is synchronous.</p></li>
<li><p>DescribeTable: Partial implementation. Missing creation date and size estimate.</p></li>
<li><p>UpdateTable: Not supported.</p></li>
<li><p>ListTables: Supported.</p></li>
</ul>
</div>
<div class="section" id="item-operations">
<h3>Item Operations<a class="headerlink" href="#item-operations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>GetItem: Support almost complete except that projection expressions can
only ask for top-level attributes.</p></li>
<li><p>PutItem: Support almost complete except that condition expressions can
only refer to to-level attributes.</p></li>
<li><p>UpdateItem: Nested documents are supported but updates to nested attributes
are not (e.g., <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">a.b[3].c=val</span></code>), and neither are nested attributes in
condition expressions.</p></li>
<li><p>DeleteItem: Mostly works, but again does not support nested attributes
in condition expressions.</p></li>
</ul>
</div>
<div class="section" id="batch-operations">
<h3>Batch Operations<a class="headerlink" href="#batch-operations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>BatchGetItem: Almost complete except that projection expressions can only
ask for top-level attributes.</p></li>
<li><p>BatchWriteItem: Supported. Doesn’t limit the number of items (DynamoDB
limits to 25) or size of items (400 KB) or total request size (16 MB).</p></li>
</ul>
</div>
<div class="section" id="scans">
<h3>Scans<a class="headerlink" href="#scans" title="Permalink to this headline">¶</a></h3>
<p>Scan and Query are mostly supported, with the following limitations:</p>
<ul class="simple">
<li><p>As above, projection expressions only support top-level attributes.</p></li>
<li><p>The ScanFilter/QueryFilter parameter for filtering results is fully
supported, but the newer FilterExpression syntax is not yet supported.</p></li>
<li><p>The “Select” options which allows to count items instead of returning them
is not yet supported.</p></li>
</ul>
</div>
<div class="section" id="secondary-indexes">
<h3>Secondary Indexes<a class="headerlink" href="#secondary-indexes" title="Permalink to this headline">¶</a></h3>
<p>Global Secondary Indexes (GSI) and Local Secondary Indexes (LSI) are
implemented, with the following limitations:</p>
<ul class="simple">
<li><p>GSIs and LSIs can be added only at CreateTable time: GSIs cannot be added
or removed at a later time (UpdateTable is not yet supported).</p></li>
<li><p>DescribeTable lists the indexes for the table, but is missing some
additional information on each index.</p></li>
<li><p>Projection of only a subset of the base-table attributes to the index is
not respected: All attributes are projected.</p></li>
</ul>
</div>
<div class="section" id="time-to-live-ttl">
<h3>Time To Live (TTL)<a class="headerlink" href="#time-to-live-ttl" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Not yet supported. Note that this is a different feature from Scylla’s
feature with the same name.</p></li>
</ul>
</div>
<div class="section" id="replication">
<h3>Replication<a class="headerlink" href="#replication" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Supported, with RF=3 (unless running on a cluster of less than 3 nodes).
Writes are done in LOCAL_QUORUM and reads in LOCAL_ONE (eventual consistency)
or LOCAL_QUORUM (strong consistency).</p></li>
</ul>
</div>
<div class="section" id="global-tables">
<h3>Global Tables<a class="headerlink" href="#global-tables" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Currently, <em>all</em> Alternator tables are created as “global” tables and can
be accessed from all the DCs existing at the time of the table’s creation.
If a DC is added after a table is created, the table won’t be visible from
the new DC and changing that requires a CQL “ALTER TABLE” statement to
modify the table’s replication strategy.</p></li>
<li><p>We do not yet support the DynamoDB API calls that control which table is
visible from what DC: CreateGlobalTable, UpdateGlobalTable,
DescribeGlobalTable, ListGlobalTables, UpdateGlobalTableSettings,
DescribeGlobalTableSettings, and UpdateTable.</p></li>
</ul>
</div>
<div class="section" id="backup-and-restore">
<h3>Backup and Restore<a class="headerlink" href="#backup-and-restore" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>On-demand backup: the DynamoDB APIs are not yet supported: CreateBackup,
DescribeBackup, DeleteBackup, ListBackups, RestoreTableFromBackup.
Users can use Scylla’s <a class="reference external" href="https://docs.scylladb.com/operating-scylla/procedures/backup-restore/">snapshots</a>
or <a class="reference external" href="https://docs.scylladb.com/operating-scylla/manager/2.0/backup/">Scylla Manager</a>.</p></li>
<li><p>Continuous backup: Not yet supported: UpdateContinuousBackups,
DescribeContinuousBackups, RestoreTableToPoinInTime.</p></li>
</ul>
</div>
<div class="section" id="transactions">
<h3>Transactions<a class="headerlink" href="#transactions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Not yet supported: TransactWriteItems, TransactGetItems.
Note that this is a new DynamoDB feature - these are more powerful than
the old conditional updates which were “lightweight transactions”.</p></li>
</ul>
</div>
<div class="section" id="streams">
<h3>Streams<a class="headerlink" href="#streams" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Implemented via <a class="reference external" href="https://docs.scylladb.com/using-scylla/cdc/">CDC</a>
(change data capture). The Alternator server responds to all DynamoDB
Streams API calls.
Note that because of how Scylla CDC operates, there is a time window
between data being written to a table and it being visible via
GetRecords calls (default 10s).</p></li>
</ul>
</div>
<div class="section" id="encryption-at-rest">
<h3>Encryption at rest<a class="headerlink" href="#encryption-at-rest" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Supported by Scylla Enterprise (not in open-source). Needs to be enabled.</p></li>
</ul>
</div>
<div class="section" id="tags">
<h3>Tags<a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Tagging tables is fully supported, at CreateTable time (with the “Tags”
parameter) and later using TagResource, UntagResource and ListTagsOfResource.</p></li>
</ul>
</div>
<div class="section" id="accounting-and-capping">
<h3>Accounting and capping<a class="headerlink" href="#accounting-and-capping" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Not yet supported. Mainly for multi-tenant cloud use, we need to track
resource use of individual requests (the API should also optionally
return this use), and be able to sum this use for different tenants and/or
tables, and possible cap use according to reservation.</p></li>
</ul>
</div>
<div class="section" id="multi-tenant-support">
<h3>Multi-tenant support<a class="headerlink" href="#multi-tenant-support" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Not yet supported (related to authorization, accounting, etc.)</p></li>
</ul>
</div>
<div class="section" id="dax-cache">
<h3>DAX (cache)<a class="headerlink" href="#dax-cache" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Not required. Scylla cache is rather advanced and there is no need to place
a cache in front of the database: https://www.scylladb.com/2017/07/31/database-caches-not-good/</p></li>
</ul>
</div>
<div class="section" id="metrics">
<h3>Metrics<a class="headerlink" href="#metrics" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Several metrics are available through the Grafana/Prometheus stack:
https://docs.scylladb.com/operating-scylla/monitoring/
Those are different from the current DynamoDB metrics, but Scylla’s
monitoring is rather advanced and provide more insights to the internals.</p></li>
</ul>
</div>
</div>
<div class="section" id="alternator-specific-api">
<h2>Alternator-specific API<a class="headerlink" href="#alternator-specific-api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="write-isolation-policies">
<h3>Write isolation policies<a class="headerlink" href="#write-isolation-policies" title="Permalink to this headline">¶</a></h3>
<p>DynamoDB API update requests may involve a read before the write - e.g., a
<em>conditional</em> update or an update based on the old value of an attribute.
The read and the write should be treated as a single transaction - protected
(<em>isolated</em>) from other parallel writes to the same item.</p>
<p>Alternator could do this isolation by using Scylla’s LWT (lightweight
transactions) for every write operation, but this significantly slows
down writes, and not necessary for workloads which don’t use read-modify-write
(RMW) updates.</p>
<p>So Alternator supports four <em>write isolation policies</em>, which can be chosen
on a per-table basis and may make sense for certain workloads as explained
below.</p>
<p>A default write isolation policy <strong>must</strong> be chosen using the
<code class="docutils literal notranslate"><span class="pre">--alternator-write-isolation</span></code> configuration option. Additionally, the write
isolation policy for a specific table can be overridden by tagging the table
(at CreateTable time, or any time later with TagResource) with the key
<code class="docutils literal notranslate"><span class="pre">system:write_isolation</span></code>, and one of the following values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">always</span></code>, or <code class="docutils literal notranslate"><span class="pre">always_use_lwt</span></code> - This mode performs every write
operation - even those that do not need a read before the write - as a
lightweight transaction.</p>
<p>This is the slowest choice, but also the only choice guaranteed to work
correctly for every workload.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">forbid</span></code>, or <code class="docutils literal notranslate"><span class="pre">forbid_rmw</span></code> - This mode <em>forbids</em> write requests
which need a read before the write. An attempt to use such statements
(e.g.,  UpdateItem with a ConditionExpression) will result in an error.
In this mode, the remaining write requests which are allowed - pure writes
without a read - are performed using standard Scylla writes, not LWT,
so they are significantly faster than they would have been in the
<code class="docutils literal notranslate"><span class="pre">always_use_lwt</span></code>, but their isolation is still correct.</p>
<p>This mode is the fastest mode which is still guaranteed to be always
safe. However, it is not useful for workloads that do need read-modify-
write requests on this table - which this mode forbids.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">o</span></code>, or <code class="docutils literal notranslate"><span class="pre">only_rmw_uses_lwt</span></code> - This mode uses LWT only for updates that
require read-modify-write, and does normal quorum writes for write-only
updates.</p>
<p>The benefit of this mode is that it allows fast write-only updates to some
items, while still allowing some slower read-modify-write operations to
other items. However, This mode is only safe if the workload does not mix
read-modify-write and write-only updates to the same item, concurrently.
It cannot verify that this condition is actually honored by the workload.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">u</span></code>, <code class="docutils literal notranslate"><span class="pre">unsafe</span></code>, or <code class="docutils literal notranslate"><span class="pre">unsafe_rmw</span></code> - This mode performs read-modify-write
operations as separate reads and writes, without any isolation guarantees.
It is the fastest option, but not safe - it does not correctly isolate
read-modify-write updates. This mode is not recommended for any use case,
and will likely be removed in the future.</p></li>
</ul>
</div>
<div class="section" id="accessing-system-tables-from-scylla">
<h3>Accessing system tables from Scylla<a class="headerlink" href="#accessing-system-tables-from-scylla" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Scylla exposes lots of useful information via its internal system tables,
which can be found in system keyspaces: ‘system’, ‘system_auth’, etc.
In order to access to these tables via alternator interface,
Scan and Query requests can use a special table name:
.scylla.alternator.KEYSPACE_NAME.TABLE_NAME
which will return results fetched from corresponding Scylla table.
This interface can be used only to fetch data from system tables.
Attempts to read regular tables via the virtual interface will result
in an error.
Example: in order to query the contents of Scylla’s system.large_rows,
pass TableName=’.scylla.alternator.system.large_rows’ to a Query/Scan request.</p></li>
</ul>
</div>
</div>
<div class="section" id="alternator-design-and-implementation">
<h2>Alternator design and implementation<a class="headerlink" href="#alternator-design-and-implementation" title="Permalink to this headline">¶</a></h2>
<p>This section provides only a very brief introduction to Alternator’s
design. A much more detailed document about the features of the DynamoDB
API and how they are, or could be, implemented in Scylla can be found in:
https://docs.google.com/document/d/1i4yjF5OSAazAY_-T8CBce9-2ykW4twx_E_Nt2zDoOVs</p>
<p>Almost all of Alternator’s source code (except some initialization code)
can be found in the alternator/ subdirectory of Scylla’s source code.
Extensive functional tests can be found in the alternator-test/
subdirectory. These tests are written in Python, and can be run against
both Alternator and Amazon’s DynamoDB; This allows verifying that
Alternator’s behavior matches the one observed on DynamoDB.
See alternator-test/README.md for more information about the tests and
how to run them.</p>
<p>With Alternator enabled on port 8000 (for example), every Scylla node
listens for DynamoDB API requests on this port. These requests, in
JSON format over HTTP, are parsed and result in calls to internal Scylla
C++ functions - there is no CQL generation or parsing involved.
In Scylla terminology, the node receiving the request acts as the the
<em>coordinator</em>, and often passes the request on to one or more other nodes -
<em>replicas</em> which hold copies of the requested data.</p>
<p>DynamoDB supports two consistency levels for reads, “eventual consistency”
and “strong consistency”. These two modes are implemented using Scylla’s CL
(consistency level) feature: All writes are done using the LOCAL_QUORUM
consistency level, then strongly-consistent reads are done with
LOCAL_QUORUM, while eventually-consistent reads are with just LOCAL_ONE.</p>
<p>Each table in Alternator is stored as a Scylla table in a separate
keyspace. The DynamoDB key columns (hash and sort key) have known types,
and become partition and clustering key columns of the Scylla table.
All other attributes may be different for each row, so are stored in one
map column in Scylla, and not as separate columns.</p>
<p>In Scylla (and its inspiration, Cassandra), high write performance is
achieved by ensuring that writes do not require reads from disk.
The DynamoDB API, however, provides many types of requests that need a read
before the write (a.k.a. RMW requests - read-modify-write). For example,
a request may copy an existing attribute, increment an attribute,
be conditional on some expression involving existing values of attribute,
or request that the previous values of attributes be returned. These
read-modify-write transactions should be <em>isolated</em> from each other, so
by default Alternator implements every write operation using Scylla’s
LWT (lightweight transactions). This default can be overridden on a per-table
basis, by tagging the table as explained above in the “write isolation
policies” section.</p>
<p>DynamoDB allows attributes to be <strong>nested</strong> - a top-level attribute may
be a list or a map, and each of its elements may further be lists or
maps, etc. Alternator currently stores the entire content of a top-level
attribute as one JSON object. This is good enough for most needs, except
one DynamoDB feature which we cannot support safely: we cannot modify
a non-top-level attribute (e.g., a.b[3].c) directly without RMW. We plan
to fix this in a future version by rethinking the data model we use for
attributes, or rethinking our implementation of RMW (as explained above).</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started With ScyllaDB Alternator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting-started.html#installing-scylla">Installing Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting-started.html#testing-scylla-s-dynamodb-api-support">Testing Scylla’s DynamoDB API support:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="compatibility.html">Scylla Alternator for DynamoDB users</a><ul>
<li class="toctree-l2"><a class="reference internal" href="compatibility.html#provisioning">Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="compatibility.html#load-balancing">Load balancing</a></li>
<li class="toctree-l2"><a class="reference internal" href="compatibility.html#write-isolation-policies">Write isolation policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="compatibility.html#unimplemented-api-features">Unimplemented API features</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>

        </div>

        <div id="sidebar" class="large-3 large-pull-6 columns"><div class="side-nav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Scylla Developer Documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Alternator: DynamoDB API in Scylla</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting-started.html">Getting Started With ScyllaDB Alternator</a></li>
<li class="toctree-l2"><a class="reference internal" href="compatibility.html">Scylla Alternator for DynamoDB users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../design-notes/index.html">Design Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribute</a></li>
</ul>

</div>
        </div>

        <div class="large-3 columns">
            
        </div>

    </div>
</section>

<!-- newsleter modal -->

<div id="newsletter_signup" class="reveal-modal tiny radius dark_modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
    <a class="close-reveal-modal" aria-label="Close">×</a>
    <h2 id="modalTitle">Sign up for the Scylla newsletter</h2>
    <div id="mc_embed_signup">
        <form action="//cloudius-systems.us10.list-manage.com/subscribe/post?u=df8bb543c68230d5f7b4dcf78&amp;id=9a4589f144" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
            <div id="mc_embed_signup_scroll">

                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-EMAIL">Email</label></div>
                        <div class="small-9 columns"><input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-FNAME">First Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="FNAME" class="" id="mce-FNAME"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-LNAME">Last Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="LNAME" class="" id="mce-LNAME"></div>
                    </div>
                </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_df8bb543c68230d5f7b4dcf78_9a4589f144" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" class="button" value="Sign up" name="subscribe" id="mc-embedded-subscribe"></div>
            </div>
        </form>
    </div>
</div>

<!-- end newsleter modal -->



<!-- footer.html -->
<footer id="footer">
    <div class="footer-top">
        <a class="logo" href="https://www.scylladb.com"><img src="../_static/img/logo-scylla-horizontal-RGB.svg" alt=""></a>
        <div class="footer-links">
            <a class="link" href="https://docs.scylladb.com">Docs</a>
            <a class="link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
            <a class="link" href="https://www.scylladb.com/company/">About Us</a>
            <a class="link button" href="https://github.com/scylladb/scylla/issues/new?title=Issue in page Alternator: DynamoDB API in Scylla&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://scylladb.github.io/scylla/master/alternator/alternator%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix" target="_blank">
                Report an issue on this page</a>
        </div>
        <div class="footer-actions">
            <a class="link-icon" href="https://github.com/ScyllaDB" target="_blank">
                <span class="icon-github2"></span></a>
            <a class="link-icon" href="https://twitter.com/ScyllaDB" target="_blank">
                <span class="icon-twitter"></span></a>
            <a class="link-icon" href="https://www.linkedin.com/company/scylladb"  target="_blank">
                <span class="icon-linkedin2"></span></a>
            <a class="link-icon" href="https://www.facebook.com/scylladb/" target="_blank">
                <span class="icon-facebook"></span></a>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="footer-info">
            <div class="footer-copyright">
                &#169; 2021, ScyllaDB. All rights reserved.
            </div>
            <div class="footer-last-updated">
                Last updated on 04 January 2021.
            </div>
        </div>
        <div class="footer-links">
        </div>
    </div>
</footer>
<!-- end footer.html -->

<!-- bodyscripts.html -->
<!-- at the end of the BODY --> 
<script src="../_static/js/vendor/jquery.js"></script>
<script src="../_static/js/vendor/jquery.cookie.min.js"></script>
<script src="../_static/expertrec.js"></script>
<script src="../_static/js/foundation/foundation.js"></script>
<script src="../_static/js/foundation/foundation.topbar.js"></script>
<script src="../_static/app.js"></script>
<script>
    $(document).foundation();
</script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <!-- end bodyscripts.html -->
</body>
</html>